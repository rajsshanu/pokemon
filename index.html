<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Retro Pokémon Personality Quiz</title>

  <!-- Pixel font -->
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

  <style>
    :root{
      --gc-purple:#663399;
      --gc-silver:#b8bcc8;
      --gc-dark:#2a1810;
      --gc-orange:#ff6600;
      --screen-bg:#1a1a2e;
      --screen-glow:#4a69bd;
      --text-light:#e8e8e8;
      --text-dark:#0f0f23;
      --accent:#ff6b35;
      --accent-dark:#cc5529;
      --button-gray:#6c7b7f;
      --button-light:#9ca3af;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background: radial-gradient(circle at 50% 50%, #1a1a2e, #16213e, #0f3460);
      display:flex;
      align-items:center;
      justify-content:center;
      font-family:'Press Start 2P', monospace;
      color:var(--text-light);
      min-height:100vh;
    }

    /* GameCube-style console */
    .gamecube{
      width:520px;
      background: linear-gradient(145deg, var(--gc-purple) 0%, #5a2d91 35%, #4a2570 100%);
      border:8px solid var(--gc-silver);
      border-radius:25px;
      box-shadow: 
        0 25px 50px rgba(0,0,0,0.8),
        inset 0 4px 8px rgba(255,255,255,0.1),
        inset 0 -4px 8px rgba(0,0,0,0.3);
      padding:25px;
      position:relative;
      overflow:hidden;
    }

    /* GameCube logo area */
    .console-header{
      text-align:center;
      margin-bottom:20px;
      padding:12px;
      background: linear-gradient(90deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05), rgba(255,255,255,0.1));
      border-radius:15px;
      border:2px solid rgba(255,255,255,0.2);
    }
    
    .console-logo{
      color:var(--gc-orange);
      font-size:14px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
      letter-spacing:2px;
    }

    /* Main gaming area */
    .gaming-area{
      display:flex;
      gap:20px;
      align-items:flex-start;
    }

    /* Left: Main screen (like GameCube's disc tray area) */
    .main-screen {
      width:340px;
      background: linear-gradient(145deg, var(--screen-bg), #16213e);
      border:6px solid var(--gc-silver);
      border-radius:20px;
      padding:18px;
      min-height:320px;
      box-shadow: 
        inset 0 8px 16px rgba(0,0,0,0.6),
        inset 0 0 20px rgba(74,105,189,0.1),
        0 0 30px rgba(74,105,189,0.3);
      position:relative;
      overflow:hidden;
    }

    /* Screen glow effect */
    .main-screen::before{
      content:'';
      position:absolute;
      top:-2px;
      left:-2px;
      right:-2px;
      bottom:-2px;
      background: linear-gradient(45deg, 
        rgba(74,105,189,0.3), 
        rgba(255,107,53,0.2), 
        rgba(74,105,189,0.3));
      border-radius:20px;
      z-index:-1;
      animation:screenGlow 3s ease-in-out infinite alternate;
    }

    @keyframes screenGlow {
      0% { opacity:0.3; }
      100% { opacity:0.7; }
    }

    /* Dialog area */
    .dialog {
      background: linear-gradient(145deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
      border:3px solid rgba(74,105,189,0.4);
      border-radius:12px;
      padding:16px;
      min-height:90px;
      display:flex;
      align-items:center;
      justify-content:center;
      text-align:center;
      font-size:11px;
      color:var(--text-light);
      box-shadow: 
        inset 0 2px 4px rgba(255,255,255,0.1),
        0 4px 8px rgba(0,0,0,0.3);
    }

    /* Options area */
    .options {
      margin-top:15px;
      display:flex;
      flex-direction:column;
      gap:10px;
      align-items:center;
    }

    /* GameCube-style buttons */
    .option-btn{
      width:92%;
      background: linear-gradient(145deg, var(--button-gray), var(--button-light));
      color:var(--text-dark);
      border:3px solid var(--gc-silver);
      border-radius:12px;
      padding:10px 8px;
      font-size:10px;
      cursor:pointer;
      transition:all 0.15s ease;
      text-align:center;
      user-select:none;
      box-shadow: 
        0 4px 8px rgba(0,0,0,0.3),
        inset 0 2px 4px rgba(255,255,255,0.3);
      position:relative;
    }

    .option-btn:hover{
      transform:translateY(-3px);
      background: linear-gradient(145deg, var(--accent), var(--accent-dark));
      color:var(--text-light);
      box-shadow: 
        0 6px 12px rgba(0,0,0,0.4),
        inset 0 2px 4px rgba(255,255,255,0.2);
    }

    .option-btn:active{
      transform:translateY(-1px);
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }

    /* Name input styling */
    .name-input {
      width:92%;
      background: linear-gradient(145deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
      color:var(--text-light);
      border:3px solid var(--gc-silver);
      border-radius:12px;
      padding:10px 8px;
      font-size:10px;
      text-align:center;
      font-family:'Press Start 2P', monospace;
      margin:8px 0;
      box-shadow: 
        inset 0 4px 8px rgba(0,0,0,0.4),
        0 2px 4px rgba(74,105,189,0.3);
    }
    .name-input::placeholder {
      color:rgba(232,232,232,0.5);
    }
    .name-input:focus {
      outline:none;
      border-color:var(--accent);
      box-shadow: 
        inset 0 4px 8px rgba(0,0,0,0.4),
        0 0 12px rgba(255,107,53,0.5);
    }

    /* Right: Controller/Info panel */
    .controller-panel{
      width:140px;
      display:flex;
      flex-direction:column;
      gap:12px;
      align-items:center;
    }

    /* Power indicator */
    .power-indicator{
      width:100%;
      height:30px;
      background: linear-gradient(90deg, var(--gc-orange), #ff8533);
      border-radius:15px;
      display:flex;
      align-items:center;
      justify-content:center;
      color:white;
      font-size:8px;
      border:2px solid rgba(255,255,255,0.3);
      box-shadow: 
        0 4px 8px rgba(0,0,0,0.3),
        inset 0 2px 4px rgba(255,255,255,0.2);
      animation:powerPulse 2s ease-in-out infinite alternate;
    }

    @keyframes powerPulse {
      0% { box-shadow: 0 4px 8px rgba(0,0,0,0.3), inset 0 2px 4px rgba(255,255,255,0.2); }
      100% { box-shadow: 0 4px 8px rgba(0,0,0,0.3), inset 0 2px 4px rgba(255,255,255,0.2), 0 0 20px rgba(255,102,0,0.6); }
    }

    /* Pokémon preview (like memory card slot) */
    .preview-slot {
      width:100%;
      height:140px;
      background: linear-gradient(145deg, #2a2a3e, #1a1a2e);
      border:4px solid var(--gc-silver);
      border-radius:15px;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:8px;
      box-shadow: 
        inset 0 6px 12px rgba(0,0,0,0.5),
        0 4px 8px rgba(0,0,0,0.3);
      position:relative;
      overflow:hidden;
    }

    .preview-slot::before{
      content:'';
      position:absolute;
      top:5px;
      left:5px;
      right:5px;
      height:2px;
      background: linear-gradient(90deg, transparent, rgba(74,105,189,0.8), transparent);
      animation:scanLine 2s linear infinite;
    }

    @keyframes scanLine {
      0% { transform:translateY(0); opacity:1; }
      50% { opacity:0.3; }
      100% { transform:translateY(120px); opacity:1; }
    }

    .preview-slot img{
      max-width:100%;
      max-height:100%;
      image-rendering: pixelated;
      filter:drop-shadow(0 0 10px rgba(74,105,189,0.5));
    }

    /* Status display */
    .status-display {
      width:100%;
      background: linear-gradient(145deg, rgba(0,0,0,0.6), rgba(0,0,0,0.3));
      border:2px solid var(--gc-silver);
      border-radius:10px;
      padding:8px;
      text-align:center;
      font-size:8px;
      color:var(--text-light);
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.5);
    }

    /* Typing caret */
    .typing { 
      display:inline-block;
      width:8px;
      height:12px;
      background:var(--accent);
      margin-left:6px;
      vertical-align:middle;
      animation:blink 1s steps(1) infinite;
      box-shadow: 0 0 4px rgba(255,107,53,0.8);
    }
    @keyframes blink{50%{opacity:0}}

    /* Result styles */
    .result-screen{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:12px;
    }
    .result-card{
      width:100%;
      background: linear-gradient(145deg, rgba(255,255,255,0.08), rgba(255,255,255,0.03));
      border:3px solid rgba(74,105,189,0.6);
      border-radius:15px;
      padding:16px;
      text-align:center;
      box-shadow: 
        inset 0 2px 4px rgba(255,255,255,0.1),
        0 8px 16px rgba(0,0,0,0.3);
    }
    .pokemon-name{
      font-size:12px;
      color:var(--accent);
      text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
    }
    .trainer-name{
      font-size:10px;
      color:var(--text-light);
      margin-bottom:8px;
      opacity:0.9;
    }
    .restart{
      background: linear-gradient(145deg, var(--gc-orange), #e55a00);
      color:white;
      border:3px solid var(--gc-silver);
      border-radius:12px;
      padding:10px 16px;
      font-size:10px;
      cursor:pointer;
      transition:all 0.15s ease;
      box-shadow: 
        0 4px 8px rgba(0,0,0,0.3),
        inset 0 2px 4px rgba(255,255,255,0.2);
    }
    .restart:hover{
      transform:translateY(-2px);
      box-shadow: 
        0 6px 12px rgba(0,0,0,0.4),
        inset 0 2px 4px rgba(255,255,255,0.3);
    }
    .restart:active{
      transform:translateY(0);
    }

    /* Helper styles */
    .muted{opacity:0.8; font-size:9px; color:var(--text-light); margin-top:8px;}

    /* Responsive adjustments */
    @media (max-width: 600px) {
      .gamecube { width:90%; min-width:300px; }
      .gaming-area { flex-direction:column; }
      .controller-panel { width:100%; flex-direction:row; justify-content:space-around; }
      .preview-slot { height:100px; }
    }
  </style>
</head>

<body>
  <div class="gamecube" role="application" aria-label="Pokemon personality quiz">
    <div class="console-header">
      <div class="console-logo">◈ POKÉCUBE QUIZ ◈</div>
    </div>
    
    <div class="gaming-area">
      <div class="main-screen" id="screen">
        <div class="dialog" id="dialog">Loading...</div>
        <div class="options" id="options"></div>
      </div>

      <div class="controller-panel">
        <div class="power-indicator">● ONLINE</div>
        <div class="preview-slot" id="preview">
          <img id="preview-img" src="https://play.pokemonshowdown.com/sprites/ani/pikachu.gif" alt="preview">
        </div>
        <div class="status-display" id="status">Welcome, trainer!</div>
      </div>
    </div>
  </div>

<script>
/* ============= QUIZ DATA ============= */
const quizQuestions = [
  { question: "What's your favorite color palette?", options: ["Neon","Pastel","Earthy","Dark tones","Red","Blue","Green","Yellow","Orange","Aqua","Brown","Purple"] },
  { question: "Pick your ideal drink:", options: ["Coffee","Matcha","Tea","Juice","Spicy","Mild","Sweet","Sour"] },
  { question: "What weather do you prefer?", options: ["Sunny","Rainy","Cloudy","Snowy"] },
  { question: "How would you describe your personality?", options: ["Fast","Calm","Steady","Unpredictable"] },
  { question: "Choose your favorite music vibe:", options: ["Rock","Jazz","Ambient","Pop","Guitar","Piano","Flute","Synthesizer"] },
  { question: "What's your favorite season?", options: ["Summer","Monsoon","Spring","Winter"] },
  { question: "Pick a Pokémon item:", options: ["Pokéball","Potion","Forest","Rare Candy","Master Ball","Berry"] },
  { question: "Choose your ideal environment:", options: ["Mountains","Ocean","Meadow","City","Volcano","Waterfall","Garden","Skyline","Laboratory","Greenhouse"] },
  { question: "Pick your favorite activity:", options: ["Action","Swimming","Hiking","Gaming","Sprint","Meditation","Yoga","Parkour"] },
  { question: "Choose a mythical creature:", options: ["Dragon","Dolphin","Deer","Tiger","Phoenix","Mermaid","Fairy","Robot"] },
  { question: "What role suits you best?", options: ["Warrior","Healer","Guardian","Inventor"] },
  { question: "Pick your ideal hangout spot:", options: ["Bonfire","Lake","Lightning","Arcade","Café","Greenhouse"] }
];

/* ============= STATE ============= */
let current = -1; // Start at -1 for name input
let answers = [];
let userName = "";

/* ============= DOM ============= */
const dialogEl = document.getElementById('dialog');
const optionsEl = document.getElementById('options');
const previewImg = document.getElementById('preview-img');
const statusEl = document.getElementById('status');

/* ============= TYPING EFFECT ============= */
function typeText(text, cb) {
  dialogEl.innerHTML = '';
  let i = 0;
  const span = document.createElement('span');
  dialogEl.appendChild(span);
  const caret = document.createElement('span');
  caret.className = 'typing';
  dialogEl.appendChild(caret);

  const speed = 18; // ms per char
  function step() {
    if (i <= text.length) {
      span.textContent = text.slice(0, i);
      i++;
      setTimeout(step, speed);
    } else {
      caret.remove();
      if (cb) cb();
    }
  }
  step();
}

/* ============= NAME INPUT SCREEN ============= */
function showNameInput() {
  typeText("Welcome to the Pokémon Personality Quiz! What's your name, trainer?", () => {});
  
  optionsEl.innerHTML = '';
  
  const nameInput = document.createElement('input');
  nameInput.className = 'name-input';
  nameInput.type = 'text';
  nameInput.placeholder = 'Enter your name';
  nameInput.maxLength = 15;
  
  const startBtn = document.createElement('button');
  startBtn.className = 'option-btn';
  startBtn.textContent = 'Start Quiz';
  startBtn.onclick = () => {
    const name = nameInput.value.trim();
    if (name) {
      playSelectSound();
      userName = name;
      current = 0;
      setTimeout(loadQuestion, 300);
    } else {
      nameInput.style.borderColor = '#ff4444';
      setTimeout(() => nameInput.style.borderColor = 'var(--gc-silver)', 1000);
    }
  };
  
  // Allow Enter key to start quiz
  nameInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
      startBtn.click();
    }
  });
  
  optionsEl.appendChild(nameInput);
  optionsEl.appendChild(startBtn);
  
  // Focus the input
  setTimeout(() => nameInput.focus(), 100);
  
  statusEl.textContent = "Enter your trainer name";
}

/* ============= LOAD / SHOW QUESTION ============= */
function shuffle(a){ for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]} return a }

function loadQuestion() {
  const q = quizQuestions[current];
  // Show question with typing animation
  typeText(q.question, () => {});
  // Clear and create option buttons
  optionsEl.innerHTML = '';
  // shuffle options for variety
  const opts = shuffle([...q.options]);
  opts.forEach(opt => {
    const btn = document.createElement('button');
    btn.className = 'option-btn';
    btn.textContent = opt;
    btn.onclick = () => {
      playSelectSound();
      selectAnswer(opt);
    };
    optionsEl.appendChild(btn);
  });

  // Update preview & status
  previewImg.src = getPreviewForQuestion(current);
  statusEl.textContent = `Question ${current+1} / ${quizQuestions.length}`;
}

/* small preview mapping per question (fun) */
function getPreviewForQuestion(index){
  const previewPool = [
    'pikachu','togepi','vulpix','squirtle','piplup','jigglypuff','psyduck','charizard','blastoise','venusaur',
    'alakazam','onix','umbreon','gardevoir','articuno'
  ];
  // rotate a bit so preview changes
  return `https://play.pokemonshowdown.com/sprites/ani/${previewPool[index % previewPool.length]}.gif`;
}

/* ============= HANDLE ANSWER ============= */
function selectAnswer(option) {
  // record
  answers.push(option);
  // small flash or preview update
  previewImg.style.transform = 'scale(0.94)';
  setTimeout(()=> previewImg.style.transform = '', 140);

  // next or finish
  current++;
  if (current < quizQuestions.length) {
    setTimeout(loadQuestion, 220);
  } else {
    setTimeout(showResult, 300);
  }
}

/* ============= POKéMON SCORING ============= */
function getPokemon(answers) {
  const points = {
    charizard:0, blastoise:0, venusaur:0, pikachu:0,
    alakazam:0, articuno:0, onix:0, umbreon:0, gardevoir:0,
    togepi:0, jigglypuff:0, vulpix:0, squirtle:0, piplup:0, psyduck:0
  };

  answers.forEach(ans => {
    // Fire / Bold -> charizard / vulpix
    if (["Neon","Coffee","Sunny","Fast","Rock","Summer","Pokéball","Red","Orange","Spicy","Mountains","Action","Dragon","Warrior","Sprint","Bonfire","Volcano","Guitar","Phoenix"].includes(ans)) {
      points.charizard++;
      if (["Orange","Red","Volcano","Bonfire","Guitar","Phoenix"].includes(ans)) points.vulpix++;
    }

    // Water / Calm -> blastoise / squirtle / piplup
    if (["Pastel","Matcha","Rainy","Calm","Jazz","Monsoon","Potion","Blue","Aqua","Mild","Ocean","Swimming","Piano","Waterfall","Dolphin","Mermaid","Healer","Meditation","Lake"].includes(ans)) {
      points.blastoise++;
      if (["Ocean","Swimming","Summer","Blue","Dolphin"].includes(ans)) points.squirtle++;
      if (["Aqua","Mild","Skyline","Piplup","Monsoon"].includes(ans)) points.piplup++;
    }

    // Grass / Earthy -> venusaur / togepi
    if (["Earthy","Tea","Cloudy","Fruit","Steady","Ambient","Spring","Forest","Green","Brown","Sweet","Meadow","Hiking","Flute","Garden","Fairy","Guardian","Yoga","Greenhouse"].includes(ans)) {
      points.venusaur++;
      if (["Pastel","Sweet","Flute","Fairy","Meadow","Lake"].includes(ans)) points.togepi++;
    }

    // Electric / quirky -> pikachu / jigglypuff / psyduck
    if (["Dark tones","Juice","Snowy","Chocolate","Unpredictable","Pop","Winter","City","Rare Candy","Master Ball","Yellow","Purple","Sour","Skyline","Gaming","Synthesizer","Lightning","Tiger","Robot","Inventor","Parkour","Laboratory","Arcade","Café"].includes(ans)) {
      points.pikachu++;
      if (["Pop","Piano","Synthesizer","Purple","Chocolate","City"].includes(ans)) points.jigglypuff++;
      if (["Unpredictable","Cloudy","Snowy","Laboratory","Robot","Juice","Arcade"].includes(ans)) points.psyduck++;
    }

    // Psychic / thoughtful -> alakazam / gardevoir
    if (["Meditation","Piano","Flute","Synthesizer","Inventor","Healer","Guardian","Fairy"].includes(ans)) {
      points.alakazam++;
      if (["Fairy","Guardian","Healer","Garden"].includes(ans)) points.gardevoir++;
    }

    // Ice / lone -> articuno
    if (["Snowy","Winter","Lake"].includes(ans)) {
      points.articuno++;
    }

    // Rock / sturdy -> onix
    if (["Mountains","Rock","Volcano","Hiking","Sprint"].includes(ans)) {
      points.onix++;
    }

    // Dark / mysterious -> umbreon
    if (["Dark tones","Night","Robot","Tiger","Unpredictable"].includes(ans)) {
      points.umbreon++;
    }

    // Additional scoring tweaks
    if (["Orange","Red","Bonfire","Volcano","Guitar","Phoenix","Action"].includes(ans)) {
      points.vulpix++;
    }

    if (["Gaming","Rare Candy","City","Arcade"].includes(ans)) {
      points.squirtle++;
      points.piplup++;
    }

    if (["Sweet","Fairy","Flute"].includes(ans)) points.togepi++;
    if (["Pop","Piano","Purple"].includes(ans)) points.jigglypuff++;
    if (["Cloudy","Unpredictable","Juice"].includes(ans)) points.psyduck++;
  });

  // Choose highest points
  const priority = ["charizard","blastoise","venusaur","pikachu","togepi","jigglypuff","vulpix","squirtle","piplup","psyduck","alakazam","gardevoir","onix","umbreon","articuno"];
  let best = priority[0];
  priority.forEach(p => {
    if (points[p] > points[best]) best = p;
  });

  return best;
}

/* ============= RESULT / UI ============= */
function showResult() {
  const pokemonKey = getPokemon(answers);
  const prettyName = pokemonKey.charAt(0).toUpperCase() + pokemonKey.slice(1);

  // Clear screen and build result
  dialogEl.innerHTML = '';
  optionsEl.innerHTML = '';

  const rs = document.createElement('div');
  rs.className = 'result-screen';

  const card = document.createElement('div');
  card.className = 'result-card';

  const trainerEl = document.createElement('div');
  trainerEl.className = 'trainer-name';
  trainerEl.textContent = `Trainer ${userName}`;

  const nameEl = document.createElement('div');
  nameEl.className = 'pokemon-name';
  nameEl.textContent = `Your Pokémon is: ${prettyName}!`;

  const gif = document.createElement('img');
  gif.style.maxWidth = '200px';
  gif.style.imageRendering = 'pixelated';
  gif.src = `https://play.pokemonshowdown.com/sprites/ani/${pokemonKey}.gif`;
  gif.alt = prettyName;
  gif.onerror = () => {
    gif.src = `https://play.pokemonshowdown.com/sprites/ani/${pokemonKey.toLowerCase().replace(/\s+/g,'')}.gif`;
  };

  const desc = document.createElement('div');
  desc.className = 'muted';
  desc.textContent = getPersonalityBlurb(pokemonKey);

  card.appendChild(trainerEl);
  card.appendChild(nameEl);
  card.appendChild(gif);
  card.appendChild(desc);

  const restart = document.createElement('button');
  restart.className = 'restart';
  restart.textContent = 'Take Quiz Again';
  restart.onclick = () => { 
    console.log('Restart button clicked'); // Debug log
    playSelectSound();
    resetQuiz(); 
  };

  rs.appendChild(card);
  rs.appendChild(restart);

  // Add to options area instead of replacing screen
  optionsEl.appendChild(rs);

  // Play victory sound
  setTimeout(() => playVictorySound(), 500);

  // update preview panel
  previewImg.src = `https://play.pokemonshowdown.com/sprites/ani/${pokemonKey}.gif`;
  statusEl.textContent = `Result: ${prettyName}`;
}

/* Short blurb per Pokémon */
function getPersonalityBlurb(key) {
  const blurbs = {
    charizard: "Fiery and adventurous — you take charge and love action.",
    blastoise: "Steady and loyal — calm under pressure and dependable.",
    venusaur: "Grounded and nurturing — connected to nature and steady growth.",
    pikachu: "Energetic and playful — sparks fly where you go.",
    togepi: "Sweet-hearted and wholesome — you brighten small moments.",
    jigglypuff: "Creative and dramatic — you love to perform and charm.",
    vulpix: "Graceful and warm — elegance with a spark of mischief.",
    squirtle: "Cool and playful — easygoing with a cheeky streak.",
    piplup: "Proud and stylish — confident with a soft heart.",
    psyduck: "Quirky and unpredictable — delightfully confusing at times.",
    alakazam: "Insightful and clever — your mind solves puzzles others can't.",
    gardevoir: "Protective and empathetic — you feel deeply and care for others.",
    onix: "Sturdy and resilient — strong, reliable, and unshakable.",
    umbreon: "Mysterious and composed — calm, cool, and quietly powerful.",
    articuno: "Calm and majestic — cool-headed with a serene presence."
  };
  return blurbs[key] || "A unique spirit — this Pokémon matches your vibe!";
}

/* ============= RESET ============= */
function resetQuiz(){
  console.log('resetQuiz() called'); // Debug log
  current = -1;
  answers = [];
  userName = "";
  
  // Clear any existing content
  dialogEl.innerHTML = '';
  optionsEl.innerHTML = '';
  
  // Reset preview
  previewImg.src = 'https://play.pokemonshowdown.com/sprites/ani/pikachu.gif';
  statusEl.textContent = 'Welcome, trainer!';
  
  // Start name input
  setTimeout(() => {
    showNameInput();
  }, 100);
}

/* ============= RETRO SOUND EFFECTS ============= */
// Create AudioContext for retro sounds
let audioContext = null;

function initAudio() {
  if (!audioContext) {
    audioContext = new (window.AudioContext || window.webkitAudioContext)();
  }
}

// GameBoy-style selection sound
function playSelectSound() {
  initAudio();
  const oscillator = audioContext.createOscillator();
  const gainNode = audioContext.createGain();
  
  oscillator.connect(gainNode);
  gainNode.connect(audioContext.destination);
  
  oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
  oscillator.frequency.exponentialRampToValueAtTime(400, audioContext.currentTime + 0.1);
  
  gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
  gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.15);
  
  oscillator.type = 'square';
  oscillator.start();
  oscillator.stop(audioContext.currentTime + 0.15);
}

// GameBoy victory fanfare
function playVictorySound() {
  initAudio();
  
  // Victory melody notes (simplified Pokemon center healing sound)
  const melody = [
    { freq: 523.25, time: 0 },     // C5
    { freq: 659.25, time: 0.15 },  // E5  
    { freq: 783.99, time: 0.3 },   // G5
    { freq: 1046.5, time: 0.45 },  // C6
    { freq: 783.99, time: 0.6 },   // G5
    { freq: 1046.5, time: 0.75 },  // C6
    { freq: 1318.5, time: 0.9 },   // E6
    { freq: 1046.5, time: 1.05 }   // C6
  ];
  
  melody.forEach(note => {
    setTimeout(() => {
      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();
      
      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);
      
      oscillator.frequency.setValueAtTime(note.freq, audioContext.currentTime);
      oscillator.type = 'square';
      
      gainNode.gain.setValueAtTime(0, audioContext.currentTime);
      gainNode.gain.linearRampToValueAtTime(0.25, audioContext.currentTime + 0.01);
      gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.12);
      
      oscillator.start();
      oscillator.stop(audioContext.currentTime + 0.12);
    }, note.time * 1000);
  });
}

/* ============= START ============= */
showNameInput();
</script>
</body>
</html>